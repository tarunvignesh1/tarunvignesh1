(self.AMP=self.AMP||[]).push({n:"amp-install-serviceworker",ev:"0.1",l:true,v:"2106182132000",m:0,f:function(AMP,_){"use strict";var h="function"==typeof Object.create?Object.create:function(a){function b(){}b.prototype=a;return new b};function k(a){for(var b=["object"==typeof globalThis&&globalThis,a,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global],c=0;c<b.length;++c){var d=b[c];if(d&&d.Math==Math)return}(function(){throw Error("Cannot find global object")})()}k(this);"function"===typeof Symbol&&Symbol("x");var l;if("function"==typeof Object.setPrototypeOf)l=Object.setPrototypeOf;else{var m;a:{var n={a:!0},p={};try{p.__proto__=n;m=p.a;break a}catch(a){}m=!1}l=m?function(a,b){a.__proto__=b;if(a.__proto__!==b)throw new TypeError(a+" is not extensible");return a}:null}var t=l;function u(a){return a||{}}var v=/(?:^[#?]?|&)([^=&]+)(?:=([^&]*))?/g;function w(a,b){var c=b=void 0===b?"":b;try{return decodeURIComponent(a)}catch(d){return c}}function x(a){var b=Object.create(null);if(!a)return b;for(var c;c=v.exec(a);){var d=w(c[1],c[1]);c=c[2]?w(c[2].replace(/\+/g," "),c[2]):"";b[d]=c}return b}var y="";function z(){var a=self;if(a.__AMP_MODE)a=a.__AMP_MODE;else{var b=x(a.location.originalHash||a.location.hash);var c=x(a.location.originalHash||a.location.hash);c=!(!["1","actions","amp","amp4ads","amp4email"].includes(c.development)&&!a.AMP_DEV_MODE);var d="2"==b.development,e=b["amp-geo"];b=b.log;if(!y){var f;y=(null==(f=a.AMP_CONFIG)?void 0:f.v)||"012106182132000"}a=a.__AMP_MODE={localDev:!1,development:c,examiner:d,esm:!1,geoOverride:e,minified:!0,test:!1,log:b,version:"2106182132000",rtvVersion:y}}return a}var A=self.AMP_CONFIG||{},B=("string"==typeof A.cdnProxyRegex?new RegExp(A.cdnProxyRegex):A.cdnProxyRegex)||/^https:\/\/([a-zA-Z0-9_-]+\.)?cdn\.ampproject\.org$/;function C(a){if(!self.document||!self.document.head||self.location&&B.test(self.location.origin))return null;var b=self.document.head.querySelector('meta[name="'+a+'"]');return b&&b.getAttribute("content")||null}var D={thirdParty:A.thirdPartyUrl||"https://3p.ampproject.net",thirdPartyFrameHost:A.thirdPartyFrameHost||"ampproject.net",thirdPartyFrameRegex:("string"==typeof A.thirdPartyFrameRegex?new RegExp(A.thirdPartyFrameRegex):A.thirdPartyFrameRegex)||/^d-\d+\.ampproject\.net$/,cdn:A.cdnUrl||C("runtime-host")||"https://cdn.ampproject.org",cdnProxyRegex:B,localhostRegex:/^https?:\/\/localhost(:\d+)?$/,errorReporting:A.errorReportingUrl||"https://us-central1-amp-error-reporting.cloudfunctions.net/r",betaErrorReporting:A.betaErrorReportingUrl||"https://us-central1-amp-error-reporting.cloudfunctions.net/r-beta",localDev:A.localDev||!1,trustedViewerHosts:[/(^|\.)google\.(com?|[a-z]{2}|com?\.[a-z]{2}|cat)$/,/(^|\.)gmail\.(com|dev)$/],geoApi:A.geoApiUrl||C("amp-geo-api")};self.__AMP_LOG=self.__AMP_LOG||{user:null,dev:null,userForEmbed:null};var E=self.__AMP_LOG;function F(){if(!E.user)throw Error("failed to call initLogConstructor");return E.user}function G(a,b,c,d,e){F().assert(a,b,c,d,e,void 0,void 0,void 0,void 0,void 0,void 0)}function H(a,b){a=a.__AMP_TOP||(a.__AMP_TOP=a);return I(a,b)}function J(a){var b=K(a);b=L(b);return I(b,"documentInfo")}function M(a){a=K(a);a=L(a);return N(a,"url")?I(a,"url"):null}function K(a){return a.nodeType?H((a.ownerDocument||a).defaultView,"ampdoc").getAmpDoc(a):a}function L(a){a=K(a);return a.isSingleDoc()?a.win:a}function I(a,b){N(a,b);var c=a.__AMP_SERVICES;c||(c=a.__AMP_SERVICES={});a=c[b];a.obj||(a.obj=new a.ctor(a.context),a.context=null,a.resolve&&a.resolve(a.obj));return a.obj}function N(a,b){a=a.__AMP_SERVICES&&a.__AMP_SERVICES[b];return!(!a||!a.ctor)}
/* https://mths.be/cssescape v1.5.1 by @mathias | MIT license */
function O(a,b){for(;a&&void 0!==a;a=a.parentElement)if(b(a))return a;return null}function P(a){return a.closest?a.closest("A"):O(a,(function(b){var c=b.matches||b.webkitMatchesSelector||b.mozMatchesSelector||b.msMatchesSelector||b.oMatchesSelector;return c?c.call(b,"A"):!1}))}var Q;function aa(a,b){var c=ba();a.addEventListener("click",(function(d){try{return b(d)}catch(g){var e,f;null==(f=(e=self).__AMP_REPORT_ERROR)||f.call(e,g);throw g}}),c?void 0:!1)}function ba(){if(void 0!==Q)return Q;Q=!1;try{var a={get capture(){Q=!0}};self.addEventListener("test-options",null,a);self.removeEventListener("test-options",null,a)}catch(b){}return Q}u({c:!0,v:!0,a:!0,ad:!0});function R(a){var b=a.indexOf("#");return-1==b?a:a.substring(0,b)}function S(a){var b=!1;void 0===b&&(b=a.hasAttribute("hidden"));b?a.removeAttribute("hidden"):a.setAttribute("hidden","")}function T(a){a=AMP.BaseElement.call(this,a)||this;a.h=null;a.F=null;a.j=H(a.win,"platform").isSafari();return a}var U=AMP.BaseElement;T.prototype=h(U.prototype);T.prototype.constructor=T;if(t)t(T,U);else for(var V in U)if("prototype"!=V)if(Object.defineProperties){var W=Object.getOwnPropertyDescriptor(U,V);W&&Object.defineProperty(T,V,W)}else T[V]=U[V];T.G=U.prototype;T.prototype.buildCallback=function(){var a=this,b=this.win;if("serviceWorker"in b.navigator){var c=M(this.element),d=this.element.getAttribute("src");c.assertHttpsUrl(d,this.element);if(!c.isProxyOrigin(d)&&!c.isProxyOrigin(b.location.href)||this.j)c.parse(b.location.href).origin==c.parse(d).origin?X(this).then((function(){return ca(a.win,d,a.element)})):this.user().error("amp-install-serviceworker","Did not install ServiceWorker because it does not match the current origin: "+d);else{var e=this.element.getAttribute("data-iframe-src");if(e){c.assertHttpsUrl(e,this.element);var f=c.parse(e).origin,g=J(this.element).get(),q=c.parse(g.sourceUrl),r=c.parse(g.canonicalUrl);G(f==q.origin||f==r.origin,"data-iframe-src (%s) should be a URL on the same origin as the source (%s) or canonical URL (%s) of the AMP-document.",f,q.origin,r.origin);this.h=e;X(this).then((function(){return da(a)}))}}(c.isProxyOrigin(d)||c.isProxyOrigin(b.location.href))&&this.j&&this.user().error("amp-install-serviceworker","Did not install ServiceWorker because of safari double keyring caching as it will not have any effect")}else ea(this)};function X(a){return Promise.all([a.loadPromise(a.win),a.getAmpDoc().whenFirstVisible()])}function da(a){return a.mutateElement((function(){S(a.element);var b=a.win.document.createElement("iframe");b.setAttribute("sandbox","allow-same-origin allow-scripts");b.src=a.h;a.element.appendChild(b)}))}function ea(a){if(a.getAmpDoc().isSingleDoc()){var b=a.getAmpDoc(),c=a.win,d=M(a.element),e=d.parse(c.location.href),f=a.element.getAttribute("data-no-service-worker-fallback-url-match"),g=a.element.getAttribute("data-no-service-worker-fallback-shell-url");if(f||g){G(f&&g,'Both, "%s" and "%s" must be specified for url-rewrite',"data-no-service-worker-fallback-url-match","data-no-service-worker-fallback-shell-url");g=R(g);try{var q=new RegExp(f)}catch(r){throw F().createError('Invalid "data-no-service-worker-fallback-url-match" expression',r)}G(d.getSourceOrigin(e)==d.parse(g).origin,'Shell source origin "%s" must be the same as source origin "%s"',g,e.href);a.F=new Y(b,q,g,a.element);d.isSecure(g)&&fa(a,g)}}}function fa(a,b){X(a).then((function(){a.mutateElement((function(){return ha(a,b)}))}))}function ha(a,b){var c=a.win.document.createElement("iframe");c.id="i-amphtml-shell-preload";c.setAttribute("src",b+"#preload");S(c);c.setAttribute("sandbox","allow-scripts allow-same-origin");a.loadPromise(c).then((function(){var d;null==(d=c.parentElement)||d.removeChild(c)}));a.element.appendChild(c)}function Y(a,b,c,d){this.win=a.win;this.D=b;this.C=c;this.A=M(d);this.o=this.A.parse(c);a=a.getRootNode();b=this.B.bind(this);aa(a,b)}Y.prototype.B=function(a){if(!a.defaultPrevented&&(a=P(a.target))&&a.href){var b=this.A.parse(a.href);if(b.origin==this.o.origin&&b.pathname!=this.o.pathname&&this.D.test(b.href)&&!a.getAttribute("i-amphtml-orig-href")){var c=this.win;R(b.href)!=R(c.location.href)&&(a.setAttribute("i-amphtml-orig-href",a.href),a.href=this.C+"#href="+encodeURIComponent(""+b.pathname+b.search+b.hash))}}};function ca(a,b,c){var d={};c.hasAttribute("data-scope")&&(d.scope=c.getAttribute("data-scope"));return a.navigator.serviceWorker.register(b,d).then((function(e){z().development&&F().info("amp-install-serviceworker","ServiceWorker registration successful with scope: ",e.scope);var f=e.installing;f?f.addEventListener("statechange",(function(g){"activated"===g.target.state&&Z(e,a,c)})):e.active&&Z(e,a,c);return e}),(function(e){F().error("amp-install-serviceworker","ServiceWorker registration failed:",e)}))}function Z(a,b,c){ia(b,a);c.hasAttribute("data-prefetch")&&ja(a,b)}function ia(a,b){if("performance"in a){var c=a.performance.getEntriesByType("resource").filter((function(e){return"script"===e.initiatorType&&e.name.startsWith(D.cdn)})).map((function(e){return e.name})),d=b.active;d.postMessage&&d.postMessage(JSON.stringify(u({type:"AMP__FIRST-VISIT-CACHING",payload:c})))}}function ja(a,b){var c=b.document,d=[].map.call(c.querySelectorAll("a[data-rel=prefetch]"),(function(e){return e.href}));ka(c)?d.forEach((function(e){var f=c.createElement("link");f.setAttribute("rel","prefetch");f.setAttribute("href",e);c.head.appendChild(f)})):(a=a.active,a.postMessage&&a.postMessage(JSON.stringify(u({type:"AMP__LINK-PREFETCH",payload:d}))))}function ka(a){var b=a.createElement("link");return b.relList&&b.relList.supports?b.relList.supports("prefetch"):!1}(function(a){a.registerElement("amp-install-serviceworker",T)})(self.AMP)}});//# sourceMappingURL=amp-install-serviceworker-0.1.js.map